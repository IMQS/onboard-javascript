<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>Javascript Onboard Project</title>
	<link rel="stylesheet" href="app.css" type="text/css"/>
	<script src="third_party/jquery-3.2.1.min.js"></script>
	<script src="app.js"></script>
</head>
<body>
<input type="hidden" id="recordsCount"/>
<table id="recordsTable" cellpadding="2">
	<tbody></tbody>
	<tfoot>
	<tr>
		<td></td>
		<td colspan="2">
		</td>
		<td>
			<input type="button" name="btnFirst" id="btnFirst" value="<<"/>
		</td>
		<td>
			<input type="button" name="btnPrev" id="btnPrev" value="<"/>
		</td>
		<td colspan="2">
		</td>
		<td>
			<input type="button" name="btnNext" id="btnNext" value=">"/>
		</td>
		<td>
			<input type="button" name="btnLast" id="btnLast" value=">>"/>
		</td>
		<td colspan="2"></td>
	</tr>
	</tfoot>
</table>
<script type="text/javascript">
	$(document).ready(function() {

		var pageHeight = $(document).height();

		// Height of cell is set in css to 40px
		var pageSize = Math.floor(pageHeight / 40);

		var recordsCount;
		var numberOfPages;
		var fromCount = 0;
		var toCount = fromCount + pageSize;

		// App instance to get columns and number of records from the server
		var recordsApp = new RecordsApp(fromCount, toCount);
		recordsApp.getRecordCount();
		recordsApp.getColumns();

		function refreshGrid() {
			// Load the next set of records
			recordsApp = new RecordsApp(fromCount, toCount);
			recordsApp.getRecords();

			recordsCount = parseInt($("#recordsCount").text());
			numberOfPages = Math.floor(recordsCount / pageSize);
		}

		$("#btnFirst").click(function() {
			fromCount = 0;
			toCount = fromCount + pageSize;
			refreshGrid();
		});

		$("#btnPrev").click(function() {
			if (fromCount > 1) {
				if ((fromCount - pageSize) > 0) {
					fromCount -= pageSize;
					toCount -= pageSize;
				} else {
					fromCount = 0;
					toCount = pageSize;
				}
			}
			refreshGrid();
		});

		$("#btnNext").click(function() {
			if (recordsCount) {
				if (toCount < recordsCount) {
					fromCount += pageSize;
					toCount += pageSize;
				}
			} else {
				fromCount += pageSize;
				toCount += pageSize;
			}

			refreshGrid();
		});

		$("#btnLast").click(function() {
			recordsCount = parseInt($("#recordsCount").text());
			numberOfPages = Math.floor(recordsCount / pageSize);

			toCount = recordsCount;
			fromCount = recordsCount - pageSize;

			refreshGrid();
		});

		$(window).resize(function() {
			pageHeight = ($(document).height() - 100);
			pageSize = Math.floor(pageHeight / 40);

			if (Math.abs(recordsCount - toCount) < pageSize) {
				toCount = recordsCount;
				fromCount = recordsCount - pageSize;
			} else {
				toCount = fromCount + pageSize;
			}

			refreshGrid();
		});

		refreshGrid();
	});

</script>
</body>
</html>